if(typeof jQuery=='undefined'){document.write(unescape("%3Cscript src='http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js' type='text/javascript'%3E%3C/script%3E"));}
jQuery('head').append('<style>.VE_Pushpin_Popup{position: absolute; z-index: 1000; display: none;}</style>');Microsoft.Maps.Pushpin.prototype.ToggleInfoBox=function(speed){if(this.GetInfoboxShown())this.HideInfobox(speed);else this.ShowInfobox(speed);};Microsoft.Maps.Pushpin.prototype.ShowInfobox=function(speed){speed=speed||'fast';if(this._infoboxWrapper){var pos=this.tryLocationToPixel(this._location,Microsoft.Maps.PixelReference.control);this._infoboxWrapper.css('left',pos.x+'px').css('top',pos.y+'px').stop(true,true).fadeIn(speed);}
this._infoboxShown=true;};Microsoft.Maps.Pushpin.prototype.HideInfobox=function(speed){speed=speed||'fast';if(this._infoboxWrapper){this._infoboxWrapper.stop(true,true).fadeOut(speed);}
this._infoboxShown=false;};Microsoft.Maps.Pushpin.prototype.GetTitle=function(){return this._title;};Microsoft.Maps.Pushpin.prototype.GetDescription=function(){return this._description;};Microsoft.Maps.Pushpin.prototype.GetSticky=function(){return this._sticky;};Microsoft.Maps.Pushpin.prototype.GetInfobox=function(){return this._infobox;};Microsoft.Maps.Pushpin.prototype.GetInfoboxShown=function(){return this._infoboxShown;};Microsoft.Maps.Pushpin.prototype._setOptions=Microsoft.Maps.Pushpin.prototype.setOptions;Microsoft.Maps.Pushpin.prototype.setOptions=function(options){var changed=false;for(var option in options){switch(option){case'title':case'description':case'sticky':case'infobox':changed=true;this['_'+option]=options[option];break;}}
if(changed)Microsoft.Maps.Events.invoke(this,'entitychanged',{entity:this});this._setOptions(options);};Microsoft.Maps.Pushpin.prototype._mouseover=function(e){var entity=e.target;if(entity)entity.ShowInfobox();};Microsoft.Maps.Pushpin.prototype._mouseout=function(e){var entity=e.target;if(entity&&!entity._sticky&&!entity._autosticky)entity.HideInfobox();};Microsoft.Maps.Pushpin.prototype._click=function(e){var entity=e.target;if(entity){if(entity.GetInfoboxShown()){if(!entity._autosticky){entity._autosticky=true;}else{entity._autosticky=false;entity.HideInfobox();}}else{entity._autosticky=true;entity.ShowInfobox();}}};Microsoft.Maps.EntityCollection.prototype._entityAdded=function(e){var entity=e.entity;if(entity instanceof Microsoft.Maps.Pushpin){var collection=e.collection;entity._infoboxShown=false;entity._autosticky=false;entity.tryLocationToPixel=collection._tryLocationToPixel;if(entity._infoboxWrapper){entity._infoboxWrapper.empty();entity._infoboxWrapper.remove();}
entity._infoboxWrapper=jQuery('<div class="VE_Pushpin_Popup"></div>');collection._rootElement.append(entity._infoboxWrapper);Microsoft.Maps.Events.addHandler(entity,'mouseover',entity._mouseover);Microsoft.Maps.Events.addHandler(entity,'mouseout',entity._mouseout);Microsoft.Maps.Events.addHandler(entity,'click',entity._click);Microsoft.Maps.Events.addHandler(entity,'touchstart',entity._click);collection._entityChanged(e);}};Microsoft.Maps.EntityCollection.prototype._entityChanged=function(e){var entity=e.entity;if(entity instanceof Microsoft.Maps.Pushpin){if(entity._infobox){if(entity._infoboxCustom){entity._infoboxWrapper.empty();}
if(entity._infoboxTitle){entity._infoboxTitle.remove();entity._infoboxTitle=false;}
if(entity._infoboxDescription){entity._infoboxDescription.remove();entity._infoboxDescription=false;}
entity._infoboxCustom=true;entity._infoboxWrapper.append(entity._infobox);}else{if(entity._infoboxCustom){entity._infoboxWrapper.empty();entity._infoboxCustom=false;}
if(entity._infoboxTitle){entity._infoboxTitle.html(entity._title);}else{entity._infoboxTitle=jQuery('<div class="Title">'+entity._title+'</div>');entity._infoboxWrapper.append(entity._infoboxTitle);}
if(entity._infoboxDescription){entity._infoboxDescription.html(entity._description);}else{entity._infoboxDescription=jQuery('<div class="Description">'+entity._description+'</div>');entity._infoboxWrapper.append(entity._infoboxDescription);}}}}
Microsoft.Maps.EntityCollection.prototype._entityRemoved=function(e){var entity=e.entity;if(entity instanceof Microsoft.Maps.Pushpin){entity.tryLocationToPixel=null;if(entity._infoboxWrapper){entity._infoboxWrapper.empty();entity._infoboxWrapper.remove();entity._infoboxWrapper=null;}
Microsoft.Maps.Events.removeHandler(entity,'mouseover',entity._mouseover);Microsoft.Maps.Events.removeHandler(entity,'mouseout',entity._mouseout);Microsoft.Maps.Events.removeHandler(entity,'click',entity._click);Microsoft.Maps.Events.removeHandler(entity,'touchstart',entity._click);}};Microsoft.Maps.Map.prototype._viewchangestart=function(){var viewreopen=this.target._viewreopen;var entities=this.target.entities;var l=entities.getLength();for(var i=0;i<l;i++){var entity=entities.get(i);if((entity instanceof Microsoft.Maps.Pushpin)&&entity.GetInfoboxShown()){if(entity._sticky||entity._autosticky)viewreopen.push(entity);entity.HideInfobox(1);}}}
Microsoft.Maps.Map.prototype._viewchangeend=function(){var viewreopen=this.target._viewreopen;var l=viewreopen.getLength();for(var i=0;i<l;i++){viewreopen.pop().ShowInfobox();}}
Microsoft.Maps._Map=Microsoft.Maps.Map;Microsoft.Maps.Map=function(container,options){var map=new Microsoft.Maps._Map(container,options);map._viewreopen=new Microsoft.Maps.EntityCollection();map.entities._tryLocationToPixel=map.tryLocationToPixel;map.entities._rootElement=jQuery(map.getRootElement());Microsoft.Maps.Events.addHandler(map.entities,'entityadded',map.entities._entityAdded);Microsoft.Maps.Events.addHandler(map.entities,'entitychanged',map.entities._entityChanged);Microsoft.Maps.Events.addHandler(map.entities,'entityremoved',map.entities._entityRemoved);Microsoft.Maps.Events.addHandler(map,'viewchangestart',map._viewchangestart);Microsoft.Maps.Events.addHandler(map,'viewchangeend',map._viewchangeend);return map;};